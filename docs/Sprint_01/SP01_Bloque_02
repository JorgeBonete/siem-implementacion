# SPRINT 1: TAREA 2 - Sincronizaci√≥n Horaria (NTP) con Chrony ‚è∞

---

Esta tarea se enfoca en asegurar que ambas m√°quinas virtuales (`nodo-coordinadorwz` y `nodo-datoswz`) mantengan una sincronizaci√≥n
horaria precisa utilizando el demonio `chronyd`. La precisi√≥n horaria es fundamental en un SIEM para la correcta correlaci√≥n de
eventos y logs. Esta configuraci√≥n se realiz√≥ en **AMBAS VMs**.

**Fecha de Completado del Sprint 1:** 04 de Julio de 2025 üóìÔ∏è

### Detalles de las M√°quinas Virtuales Provisionadas: üöÄ

* **VM1 (Rol: Wazuh Manager)**
    * **Nombre de Host (Hostname):** `nodo-coordinadorwz.dominio.com.ec`
    * **Direcci√≥n IP:** `192.168.1.10`

* **VM2 (Rol: Wazuh Indexer & Dashboard)**
    * **Nombre de Host (Hostname):** `nodo-datoswz.dominio.com.ec`
    * **Direcci√≥n IP:** `192.168.1.20`

‚ú® --- ‚ú®

## Pasos de Configuraci√≥n: ‚öôÔ∏è

### Paso 1: Instalar Chrony üì¶

Se verific√≥ e instal√≥ el paquete `chrony` en ambas VMs, que es necesario para la sincronizaci√≥n horaria.

**Comando:**

üíª ```bash
[admin@nodo-coordinadorwz ~]$ sudo dnf install -y chrony
```

**‚úÖ Salida Esperada (fragmento, si ya est√° instalado o al instalar):**
```
Last metadata expiration check: X:XX:XX ago on Fri 04 Jul 2025 ...
Package chrony-X.X-X.el9.x86_64 is already installed.
Dependencies resolved.
Nothing to do.
Complete!
```

‚ú® --- ‚ú®

### Paso 2: Configurar Chrony üìú

Se modific√≥ el archivo de configuraci√≥n de chrony para apuntar a servidores NTP adecuados y se habilit√≥ la sincronizaci√≥n autom√°tica.

**Editar el archivo de configuraci√≥n:**

üíª ```bash
[admin@nodo-coordinadorwz ~]$ sudo nano /etc/chrony.conf
```

**Contenido del archivo `/etc/chrony.conf`:**
```
# Servidores NTP recomendados para la regi√≥n de Ecuador
server 0.ec.pool.ntp.org iburst
server 1.ec.pool.ntp.org iburst
server 2.ec.pool.ntp.org iburst
server 3.ec.pool.ntp.org iburst

makestep 1.0 -1
logdir /var/log/chrony
```

‚ú® --- ‚ú®

### Paso 3: Habilitar, Iniciar y Verificar el Servicio Chrony ‚úÖ

Se habilit√≥ chronyd para que se inicie autom√°ticamente con el sistema, se inici√≥ el servicio y se verific√≥ su estado y la sincronizaci√≥n con los servidores NTP.

**Habilitar e iniciar el servicio:**

üíª ```bash
[admin@nodo-coordinadorwz ~]$ sudo systemctl enable --now chronyd
```

**Reiniciar el servicio (para aplicar cambios):**

üíª ```bash
[admin@nodo-coordinadorwz ~]$ sudo systemctl restart chronyd
```

**Verificar el estado del servicio:**

üíª ```bash
[admin@nodo-coordinadorwz ~]$ sudo systemctl status chronyd
```

**‚úÖ Salida Esperada:**
```
‚óè chronyd.service - NTP client/server
     Loaded: loaded (/usr/lib/systemd/system/chronyd.service; enabled; vendor preset: enabled)
     Active: active (running) since Fri 2025-07-04 ...
```

**Verificar la sincronizaci√≥n con los servidores NTP:**

üíª ```bash
[admin@nodo-coordinadorwz ~]$ chronyc sources -v
```

**‚úÖ Salida Esperada (fragmento):**
```
210 Number of sources = X
MS Name/IP address         Stratum Poll Reach LastRx Last sample
^* mrtg.wisp.net.ec             2     6    377    25   +60us[+100us] +/-   20ms
^+ ntp.telecu.cloud             2     6    377    26  +100us[+120us] +/-   30ms
```

Un `^*` o `^+` indica que `chrony` est√° sincronizado correctamente.

